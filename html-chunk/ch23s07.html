<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7. 指向数组的指针与多维数组</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C编程一站式学习" /><link rel="up" href="ch23.html" title="第 23 章 指针" /><link rel="prev" href="ch23s06.html" title="6. 指向指针的指针与指针数组" /><link rel="next" href="ch23s08.html" title="8. 函数类型和函数指针类型" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7. 指向数组的指针与多维数组</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch23s06.html">上一页</a> </td><th width="60%" align="center">第 23 章 指针</th><td width="20%" align="right"> <a accesskey="n" href="ch23s08.html">下一页</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2813032"></a>7. 指向数组的指针与多维数组</h2></div></div></div><p>指针可以指向复合类型，上一节讲了指向指针的指针，这一节学习指向数组的指针。以下定义一个指向数组的指针，该数组有10个<code class="literal">int</code>元素：</p><pre class="programlisting">int (*a)[10];</pre><p>和上一节指针数组的定义<code class="literal">int *a[10];</code>相比，仅仅多了一个<code class="literal">()</code>括号。如何记住和区分这两种定义呢？我们可以认为<code class="literal">[]</code>比<code class="literal">*</code>有更高的优先级，如果<code class="literal">a</code>先和<code class="literal">*</code>结合则表示<code class="literal">a</code>是一个指针，如果<code class="literal">a</code>先和<code class="literal">[]</code>结合则表示<code class="literal">a</code>是一个数组。<code class="literal">int *a[10];</code>这个定义可以拆成两句：</p><pre class="programlisting">typedef int *t;
t a[10];</pre><p><code class="literal">t</code>代表<code class="literal">int *</code>类型，<code class="literal">a</code>则是由这种类型的元素组成的数组。<code class="literal">int (*a)[10];</code>这个定义也可以拆成两句：</p><pre class="programlisting">typedef int t[10];
t *a;</pre><p><code class="literal">t</code>代表由10个<code class="literal">int</code>组成的数组类型，<code class="literal">a</code>则是指向这种类型的指针。</p><p>现在看指向数组的指针如何使用：</p><pre class="programlisting">int a[10];
int (*pa)[10] = &amp;a;</pre><p><code class="literal">a</code>是一个数组，在<code class="literal">&amp;a</code>这个表达式中，数组名做左值，取整个数组的首地址赋给指针<code class="literal">pa</code>。注意，<code class="literal">&amp;a[0]</code>表示数组<code class="literal">a</code>的首元素的首地址，而<code class="literal">&amp;a</code>表示数组<code class="literal">a</code>的首地址，显然这两个地址的数值相同，但这两个表达式的类型是两种不同的指针类型，前者的类型是<code class="literal">int *</code>，而后者的类型是<code class="literal">int (*)[10]</code>。<code class="literal">*pa</code>就表示<code class="literal">pa</code>所指向的数组<code class="literal">a</code>，所以取数组的<code class="literal">a[0]</code>元素可以用表达式<code class="literal">(*pa)[0]</code>。注意到<code class="literal">*pa</code>可以写成<code class="literal">pa[0]</code>，所以<code class="literal">(*pa)[0]</code>这个表达式也可以改写成<code class="literal">pa[0][0]</code>，<code class="literal">pa</code>就像一个二维数组的名字，它表示什么含义呢？下面把<code class="literal">pa</code>和二维数组放在一起做个分析。</p><p><code class="literal">int a[5][10];</code>和<code class="literal">int (*pa)[10];</code>之间的关系同样类似于<code class="literal">int a[10];</code>和<code class="literal">int *pa;</code>之间的关系：<code class="literal">a</code>是由一种元素组成的数组，<code class="literal">pa</code>则是指向这种元素的指针。所以，如果<code class="literal">pa</code>指向<code class="literal">a</code>的首元素：</p><pre class="programlisting">int a[5][10];
int (*pa)[10] = &amp;a[0];</pre><p>则<code class="literal">pa[0]</code>和<code class="literal">a[0]</code>取的是同一个元素，唯一比原来复杂的地方在于这个元素是由10个<code class="literal">int</code>组成的数组，而不是基本类型。这样，我们可以把<code class="literal">pa</code>当成二维数组名来使用，<code class="literal">pa[1][2]</code>和<code class="literal">a[1][2]</code>取的也是同一个元素，而且<code class="literal">pa</code>比<code class="literal">a</code>用起来更灵活，数组名不支持赋值、自增等运算，而指针可以支持，<code class="literal">pa++</code>使<code class="literal">pa</code>跳过二维数组的一行（40个字节），指向<code class="literal">a[1]</code>的首地址。</p><div class="simplesect" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a id="id2813445"></a>习题</h3></div></div></div><p>1、定义以下变量：</p><pre class="programlisting">char a[4][3][2] = {{{'a', 'b'}, {'c', 'd'}, {'e', 'f'}},
		   {{'g', 'h'}, {'i', 'j'}, {'k', 'l'}},
		   {{'m', 'n'}, {'o', 'p'}, {'q', 'r'}},
		   {{'s', 't'}, {'u', 'v'}, {'w', 'x'}}};

char (*pa)[2] = &amp;a[1][0];
char (*ppa)[3][2] = &amp;a[1];</pre><p>要想通过<code class="literal">pa</code>或<code class="literal">ppa</code>访问数组<code class="literal">a</code>中的<code class="literal">'r'</code>元素，分别应该怎么写？</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch23s06.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="ch23.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="ch23s08.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6. 指向指针的指针与指针数组 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 8. 函数类型和函数指针类型</td></tr></table></div></body></html>
